webpackJsonp([3],{GNhK:function(e,t){},fZX7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("1HuH"),r=a("P9l9"),s=a("U+Q4"),n={name:"addGroup",props:["show"],data:function(){return{dialogVisible:this.show,nodeList:[],loading:!1,groupId:null,groupFrom:{generateGroupId:"",description:"",nodeList:[],timestamp:0},rules:{generateGroupId:[{required:!0,message:"请输入群组编号",trigger:"blur"}]}}},mounted:function(){this.getFrontList()},methods:{modelClose:function(){this.$emit("close")},getFrontList:function(){var e=this,t={chainId:localStorage.getItem("chainId")};Object(r.g)(t).then(function(t){0===t.data.code&&(e.nodeList=t.data.data)})},handleSelectionChange:function(e){if(this.groupFrom.nodeList=[],e&&e.length)for(var t=0;t<e.length;t++)this.groupFrom.nodeList.push(e[t].nodeId)},submit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.newGroup()})},newGroup:function(){var e=this,t={chainId:localStorage.getItem("chainId"),generateGroupId:this.groupFrom.generateGroupId,timestamp:(new Date).getTime(),nodeList:this.groupFrom.nodeList,description:this.groupFrom.description};Object(r.c)(t).then(function(t){0===t.data.code?(e.groupId=t.data.data.groupId,e.startAllGroup(e.groupId,e.groupFrom.nodeList)):4==t.data.code||5==t.data.code||6==t.data.code||7==t.data.code?e.$message({type:"error",message:t.data.message}):e.$message({type:"error",message:s.a.errCode[t.data.code].zh})}).catch(function(t){e.$message({type:"error",message:"系统错误"})})},startAllGroup:function(e,t){var a=this,o={chainId:localStorage.getItem("chainId"),generateGroupId:e,nodeList:t};Object(r.d)(o).then(function(e){0===e.data.code?a.update():4==e.data.code||5==e.data.code||6==e.data.code||7==e.data.code?a.$message({type:"error",message:e.data.message}):a.$message({type:"error",message:s.a.errCode[e.data.code].zh})}).catch(function(e){a.$message({type:"error",message:"系统错误"})})},update:function(){var e=this;Object(r.l)().then(function(t){0===t.data.code?(e.$message({type:"success",message:"群组创建成功！"}),e.loading=!1,e.modelClose()):4==t.data.code||5==t.data.code||6==t.data.code||7==t.data.code?e.$message({type:"error",message:t.data.message}):e.$message({type:"error",message:s.a.errCode[t.data.code].zh})}).catch(function(t){e.$message({type:"error",message:"系统错误"})})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"dialog-wrapper",attrs:{title:"新增群组",visible:e.dialogVisible,"before-close":e.modelClose,width:"65%",center:!0,"show-close":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a("el-form",{ref:"groupFrom",staticClass:"demo-ruleForm",attrs:{model:e.groupFrom,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{staticStyle:{width:"330px"},attrs:{label:"群组编号",prop:"generateGroupId"}},[a("el-input",{model:{value:e.groupFrom.generateGroupId,callback:function(t){e.$set(e.groupFrom,"generateGroupId",t)},expression:"groupFrom.generateGroupId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"节点列表"}},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.nodeList,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"前置编号",prop:"frontId",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nodeId",label:"节点编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"frontIp",label:"前置IP",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"frontPort",label:"前置端口",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"agency",label:"所属机构",width:"180"}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"330px"},attrs:{label:"备注"}},[a("el-input",{model:{value:e.groupFrom.description,callback:function(t){e.$set(e.groupFrom,"description",t)},expression:"groupFrom.description"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.modelClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.submit("groupFrom")}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var i=a("VU/8")(n,d,!1,function(e){a("GNhK")},null,null).exports,l=a("YaEn"),c={name:"front",components:{"v-content-head":o.a,"add-group":i},data:function(){return{groupData:[],loading:!1,addGroupShow:!1}},mounted:function(){localStorage.getItem("chainId")&&this.getGroupList()},methods:{changGroup:function(){this.getGroupList()},createGroup:function(){this.addGroupShow=!0},getGroupList:function(){var e=this;Object(r.h)(localStorage.getItem("chainId")).then(function(t){0===t.data.code?e.groupData=t.data.data:e.$message({type:"error",message:s.a.errCode[t.data.code].zh})}).catch(function(t){e.$message({type:"error",message:"系统错误"})})},addGroupClose:function(){this.addGroupShow=!1,localStorage.getItem("chainId")&&this.getGroupList()},route:function(e){l.a.push({path:"/node",query:{groupName:e.groupName,groupId:e.groupId}})}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-content-head",{attrs:{headTitle:"群组管理"},on:{changGroup:e.changGroup}}),e._v(" "),a("div",{staticClass:"module-wrapper"},[a("h3",{staticStyle:{padding:"20px 0 0 40px"}},[e._v("群组列表")]),e._v(" "),a("div",{staticClass:"search-part",staticStyle:{"padding-top":"20px"}},[a("div",{staticClass:"search-part-left"},[a("el-button",{staticClass:"search-part-left-btn",attrs:{type:"primary"},on:{click:e.createGroup}},[e._v("新增群组")])],1)]),e._v(" "),a("div",{staticClass:"search-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"search-table-content",attrs:{data:e.groupData}},[a("el-table-column",{attrs:{prop:"groupId",label:"群组编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"groupName",label:"群组名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"group-route",on:{click:function(a){return e.route(t.row)}}},[e._v(e._s(t.row.groupName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"nodeCount",label:"节点数量"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}})],1)],1)]),e._v(" "),e.addGroupShow?a("add-group",{attrs:{show:e.addGroupShow},on:{close:e.addGroupClose}}):e._e()],1)},staticRenderFns:[]};var p=a("VU/8")(c,u,!1,function(e){a("uA61")},"data-v-8059a0e0",null);t.default=p.exports},uA61:function(e,t){}});